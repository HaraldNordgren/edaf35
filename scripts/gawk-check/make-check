#!/bin/bash

#VERSION="3.1.8"
VERSION="4.1.3"

if [ $# -ne 2 ]; then
    echo "Usage: $0 <gawk-version> <malloc-folder>"
    exit 1
fi

reset
source "scripts/test-scripts/terminal-formatting"

GAWK_FOLDER="gawk/gawk-$1"
MALLOC_FOLDER="../../${2%/}"

echo ${blue}${bold}
echo "Linking malloc files..."

cd $GAWK_FOLDER
ln -fs "$MALLOC_FOLDER/alloc.c" "malloc.c"
ln -fs "$MALLOC_FOLDER/alloc.h" "alloc.h" 
echo "Done."

echo
echo "Running make check"
echo ${reset}
make check

echo ${reset}
